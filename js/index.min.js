!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e){"use strict";function n(t){return new Promise(function(e,n){return setTimeout(e,t)})}var i,s={status:{clear_delay:null,strict:!0,time:0,sequence:[],input:[],enabled:!1,playing_sequence:!1},set_play_buttons:function(){function t(){if(i.enabled){i.enabled=!1,i.input.push(this),s.flash(this),i.clear_delay=n(100);var t=i.clear_delay;n(2500).then(function(){t===i.clear_delay&&e.call(s)})}}function e(){var t=this;i.clear_delay&&i.clear_delay.then(function(){i.enabled=!0,i.clear_delay=null,t.clear(),t.verify()})}[].forEach.call(this.buttons,function(e){e.addEventListener("mousedown",t),e.addEventListener("touchstart",function(e){t.call(this),e.preventDefault()})}),window.addEventListener("mouseup",e.bind(this)),window.addEventListener("touchend",e.bind(this))},set_control_buttons:function(){var t=this;document.querySelector("#start").addEventListener("click",function(){return t.start(1e3)}),document.querySelector("#reset").addEventListener("click",this.reset.bind(this))},set_strict_button:function(){document.querySelector("#toggle_strict").addEventListener("click",function(){s.status.strict=!s.status.strict,document.querySelector("#strict_display").innerText=s.status.strict?"On":"Off",document.querySelector("#strict_display").className=s.status.strict?"strict_on":"strict_off"})},init:function(){this.buttons=document.querySelectorAll(".play"),this.sounds={top_left:document.getElementById("s1"),top_right:document.getElementById("s2"),bottom_left:document.getElementById("s3"),bottom_right:document.getElementById("s4")},this.set_play_buttons(),this.set_control_buttons(),this.set_strict_button(),i=this.status},start:function(t){var e=this;i.time=t||1e3,this.reset().then(function(){e.add(),e.play_sequence()})},reset:function(){return document.querySelector("#count").innerText=0,i.sequence=[],i.input=[],this.clear(),i.playing?(i.playing=!1,n(i.time)):n(0)},play_sequence:function(){var t=this;i.playing=!0;var e=Promise.resolve();i.sequence.forEach(function(s){e=e.then(function(){if(!i.playing)return t.clear(),Promise.reject("Playback cancelled - game state reset during sequence playback")}).then(t.flash.bind(t,s)).then(function(){return n(.75*i.time)}).then(t.clear.bind(t)).then(function(){return n(.25*i.time)})}),e.then(function(){s.clear(),i.time=i.time>=250?i.time-50:i.time,i.playing=!1,i.input=[],i.enabled=!0})["catch"](function(t){return console.log(t)})},verify:function(){var t=this,e=!0;i.input.forEach(function(t,n){i.sequence[n]!==t&&(e=!1)}),e?i.sequence.length==i.input.length&&(i.enabled=!1,document.querySelector("#count").innerText=i.sequence.length,this.add(),n(i.time).then(this.play_sequence.bind(this))):(i.enabled=!1,[].forEach.call(this.buttons,function(e){return t.flash(e)}),n(i.time).then(this.clear.bind(this)).then(function(){return n(i.time/2)}).then(i.strict?null:this.play_sequence.bind(this)))},add:function(){i.sequence.push(this.buttons[Math.floor(4*Math.random())])},flash:function(t){var e=this.sounds[t.id];e.pause(),n(0).then(function(){e.currentTime=0,e.play()}),t.classList.add(t.id+"_flash")},clear:function(){[].forEach.call(this.buttons,function(t){return t.classList.remove(t.id+"_flash")})}};window.onload=function(){s.init()}}]);